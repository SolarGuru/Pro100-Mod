require("default");local v0=84 -44 ;local v1=238 -88 ;local v2=900;local v3=0.01 -0 ;local v4=0 + 0 ;local v5={};local v6={};local v7={};local v8={};local v9={};local v10={};local v11={};local v12={};function GetModifiedDamage(v13,v14,v15)local v16=GetStrength(v14) -(16 + 9) ;local v17=436 -(115 + 281) ;if v14.isServer then if v13.currWeapon then v10[v13.id]={v13.currWeapon.damageMin,v13.currWeapon.damageMax};v11[v13.id]=v13.currWeapon.actions;local v392=v13.currWeapon.prototype.typeId;if ((v392==WeaponType.Bow) or (v392==WeaponType.Crossbow) or (v392==WeaponType.Dagger)) then v12[v13.id]=true;else v12[v13.id]=false;end else local v393=0 -0 ;while true do if (v393==(0 -0)) then v11[v13.id]=v17;if (v10[v13.id]==nil) then v10[v13.id]={v15,v15};elseif ((v15~=v10[v13.id][1]) and (v15~=v10[v13.id][2 -0 ])) then if (v15>v10[v13.id][2 -0 ]) then if (v10[v13.id][2 -1 ]==v9[v13.id]) then v10[v13.id][286 -(134 + 151) ]=v10[v13.id][1667 -(970 + 695) ];end v10[v13.id][2]=v15;elseif (v15<v10[v13.id][1 -0 ]) then if (v10[v13.id][1]==v9[v13.id]) then v10[v13.id][1992 -(582 + 1408) ]=v10[v13.id][3 -2 ];end v10[v13.id][1 -0 ]=v15;elseif ((v10[v13.id][3 -2 ]==v9[v13.id]) or (v10[v13.id][1825 -(1195 + 629) ]==(0 -0))) then v10[v13.id][242 -(187 + 54) ]=v15;elseif ((v10[v13.id][782 -(162 + 618) ]==v9[v13.id]) or (v10[v13.id][1 + 0 ]==(0 + 0))) then v10[v13.id][3 -1 ]=v15;end end break;end end end end if (v12[v13.id] and (v12[v13.id]==true)) then return v15;end if v11[v13.id] then v17=v11[v13.id];end local v18=v13:spellEffect(SpellType.Strengthen);local v19=v13:spellEffect(SpellType.Weaken);v18=math.max(0,((v18-v15) * v17)/(168 -68) );v19=math.max(0 + 0 ,((v19-v15) * v17)/(1736 -(1373 + 263)) );return (v15 + v16 + v18) -v19 ;end function GetModifiedDamageOnClient(v20,v21,v22)local v23=1000 -(451 + 549) ;local v24;local v25;while true do if ((1 + 0)==v23) then return GetModifiedDamage(v25,v24,v22);end if (0==v23) then v24=UnitClientStats(v20);v25=UnitClient(v21);v23=1 -0 ;end end end function GetModifiedDamageOnServer(v26,v27,v28)local v29=0 -0 ;local v30;local v31;while true do if (v29==1) then return GetModifiedDamage(v31,v30,v28);end if (v29==0) then v30=UnitServerStats(v26);v31=UnitServer(v27);v29=1385 -(746 + 638) ;end end end function CalcBaseHealth(v32)return 38 + 62 ;end function CalcBaseMana(v33)return 100;end function GetModifiedHealth(v34,v35,v36)return v36;end function RegenerateHp(v37,v38,v39)local v40=0 -0 ;local v41;local v42;local v43;local v44;local v45;local v46;local v47;local v48;local v49;local v50;local v51;while true do if (v40==(346 -(218 + 123))) then if (v51<(1581 -(1535 + 46))) then local v421=0 + 0 ;while true do if (v421==0) then for v503=0 + 0 ,565 -(306 + 254)  do local v504=v42:hitLocation(v503);if (v504.hp>=v504.maxHp) then v504.hp=math.max(0 + 0 ,v504.maxHp-(0.001 -0) );end end if ((v45.curr + v51)<1) then v51=math.max(0,(1468 -(899 + 568)) -v45.curr );end break;end end end v42:heal(v37,v51);if (v45.curr>v45.max) then v45.curr=v45.max;end v40=4 + 2 ;end if (v40==2) then if v7[v43.id] then if (v7[v43.id]>v45.curr) then local v475=0 -0 ;local v476;local v477;while true do if (v475==(604 -(268 + 335))) then v477=v476/2 ;v41.mp.curr=math.max(0.1,v41.mp.curr-v477 );v475=2;end if (v475==(290 -(60 + 230))) then v476=v7[v43.id] -v45.curr ;v6[v43.id]=v1;v475=1;end if (v475==2) then v8[v43.id]=math.max(572.1 -(426 + 146) ,v8[v43.id] -v477 );break;end end elseif (v7[v43.id]<v45.curr) then local v505=0;local v506;while true do if (v505==1) then v42:heal(v37,v506);break;end if (v505==0) then v506=v45.curr-v7[v43.id] ;v506=math.max(0,(v506 * 999) -CalcArmor(v43,DamageType.General) );v505=1;end end end end v46=math.max(0,((v43:spellEffect(SpellType.Regeneration) -GetUnitArmor(v43,v41,DamageType.General))/10)/(2 + 13) );v47=math.max(1456 -(282 + 1174) ,((v43:spellEffect(SpellType.Stench) -GetUnitArmor(v43,v41,DamageType.General))/(821 -(569 + 242)))/(43 -28) );v40=1 + 2 ;end if (v40==3) then v48=RecalcDamageModifier(v42,BodyPartType.Body);v49=0;if (v6[v43.id]<=(1024 -(706 + 318))) then v49=v3 * 100 ;v44=true;end v40=1255 -(721 + 530) ;end if (v40==0) then v41=UnitServerCommonStats(v37);v42=UnitServerStats(v38);v43=UnitServer(v39);v40=1272 -(945 + 326) ;end if (v40==(2 -1)) then v44=false;v45=v41.hp;for v394=0 + 0 ,5 do local v395=v42:hitLocation(v394);v395.hp=math.max(700 -(271 + 429) ,v395.hp);end v40=2 + 0 ;end if (v40==(1506 -(1408 + 92))) then v7[v43.id]=v45.curr;return v44;end if (v40==4) then v50=((v45.regen * (1186 -(461 + 625))) + v42:perkModifier(PerkType.Vitality))/(1303 -(993 + 295)) ;v51=((v48 * (v49 + v50)) + v46) -v47 ;v51=math.min(v45.max-v45.curr ,v51);v40=5;end end end function RegenerateMp(v52,v53,v54,v55)local v56=0 + 0 ;local v57;local v58;local v59;local v60;local v61;while true do if (v56==(1174 -(418 + 753))) then if (v61.curr<v61.max) then local v424=0 + 0 ;local v425;local v426;local v427;local v428;while true do if (v424==(0 + 0)) then v425=v61.regen/15 ;if (v6[v59.id]>(0 + 0)) then if (v59.isMoving or IsMage(v59)) then v425=0;else v425=v425/5 ;end end v424=1 + 0 ;end if (v424==(530 -(406 + 123))) then v426=1 -(v58:perkModifier(PerkType.Mana) * (1769.01 -(1749 + 20))) ;v427=1 + 0 ;v424=1324 -(1249 + 73) ;end if ((1 + 1)==v424) then if  not v59.isAggressive then v427=(1146 -(466 + 679)) + (v58:perkModifier(PerkType.Spirit) * (0.01 -0)) ;end v428=RecalcDamageModifier(v58,BodyPartType.Body);v424=8 -5 ;end if (v424==(1903 -(106 + 1794))) then v57:regenMp(v425 * v427 * v428 * v426 );v60=true;break;end end else v61.curr=v61.max;end if v55 then local v431=0;local v432;local v433;local v434;local v435;local v436;while true do if (v431==(1 + 0)) then if v59.currWeapon then v433=v59.currWeapon.actions;elseif v59.nawActions then v433=v59.nawActions;end v434=1 -(v58:perkModifier(PerkType.Mana) * 0.01) ;v431=2;end if (v431==(1 + 2)) then if ((v59.isPlayer and v59.isAggressive) or ( not v59.isPlayer and (v61.curr>((194 -128) + v435)) and  not IsMage(v59))) then v436=2 -1 ;end v61.curr=math.max(0.1,v61.curr-(v435 * v436) );break;end if (0==v431) then v432=(115 -(4 + 110)) + ((584.02 -(57 + 527)) * (GetDexterity(v58) -(1452 -(41 + 1386)))) ;v433=143 -(17 + 86) ;v431=1 + 0 ;end if ((3 -1)==v431) then v435=((v433 * v434)/v432)/10 ;v436=0.5;v431=8 -5 ;end end end v56=4;end if (v56==1) then v59=UnitServer(v54);v60=false;v56=168 -(122 + 44) ;end if (v56==(2 -0)) then v61=v57.mp;if (v8[v59.id] and (v8[v59.id]>v61.curr)) then local v437=0 -0 ;local v438;while true do if ((0 + 0)==v437) then v438=v8[v59.id] -v61.curr ;v61.curr=math.max(0.1,v61.curr-(v438 * (145 + 855)) );v437=1;end if (1==v437) then v6[v59.id]=v1;break;end end end v56=5 -2 ;end if (v56==(69 -(30 + 35))) then v8[v59.id]=v61.curr;return v60;end if (v56==(0 + 0)) then v57=UnitServerCommonStats(v52);v58=UnitServerStats(v53);v56=1258 -(1043 + 214) ;end end end function RegenerateHpAndMp(v62,v63,v64,v65)local v66=0 -0 ;local v67;local v68;local v69;local v70;local v71;local v72;local v73;while true do if (v66==(1212 -(323 + 889))) then v67=UnitServerCommonStats(v62);v68=UnitServerStats(v63);v69=UnitServer(v64);if (v69.pose==UnitPoseType.Rest) then v65=false;end v66=1;end if (v66==(10 -6)) then v73=RegenerateMp(v62,v63,v64,v71);return v72 or v73 or true ;end if (v66==1) then if (v6[v69.id]==nil) then v6[v69.id]=0;end v70=v6[v69.id];v71=false;if (v70>v1) then v70=v1;v71=true;end v66=582 -(361 + 219) ;end if (v66==(323 -(53 + 267))) then v68:percept(SenseType.Tracking).curr=RecalcDamageModifier(v68,BodyPartType.Leg) * 100 ;v68:sense(SenseType.Smell).curr=v67.mp.curr;if v69.isPlayer then CalcPlayersCount(v69);end v72=RegenerateHp(v62,v63,v64);v66=1 + 3 ;end if ((415 -(15 + 398))==v66) then if ((v69.isMoving and (v69.pose==UnitPoseType.Run)) or (v65 and  not v69.isMoving and  not v69.isPlayer and (v70>(v1/(987 -(18 + 964)))))) then v70=math.min(v1,v70 + 10 );elseif (v70>0) then v70=v70-(3 -2) ;end v6[v69.id]=v70;RecalcSight(v69,v68);v68:percept(SenseType.Smell).curr=RecalcDamageModifier(v68,BodyPartType.Head) * (58 + 42) ;v66=3;end end end function CalcRunningManaCost(v74,v75,v76)local v77=0 + 0 ;local v78;local v79;local v80;local v81;local v82;local v83;while true do if (v77==0) then v78=UnitServerStats(v74);v79=UnitServer(v75);v77=851 -(20 + 830) ;end if (v77==(1 + 0)) then v80=UnitServerCommonStats(v76);v81=v80.mp;v77=128 -(116 + 10) ;end if (v77==(1 + 1)) then v82=(763 -(542 + 196))/v78.dexterity.curr ;v83=(1 -0) -(v78:perkModifier(PerkType.Mana) * (0.01 + 0)) ;break;end end end function GetSkillPrice(v84)return (13 + 12) * ((1 + 1)^(v84/(12 -7))) ;end function GetSkillPriceDiff(v85,v86)return math.floor(GetSkillPrice(v86) -GetSkillPrice(v85) );end function GetPerkPrice(v87,v88)local v89=UnitServerStats(v87);local v90=PerksDatabase.PerksTableRecord(v88);local v91=GetSkillPriceDiff(v90.cost-(25 -15) ,v90.cost);local v92=0;for v315=1551 -(1126 + 425) ,440 -(118 + 287)  do v92=v92 + v89.perks:value(v315) ;end v91=v91 * ((15 -11)^v92) ;if (v91>(1000001121 -(118 + 1003))) then v91=2926430980 -1926430980 ;end local v93=(387 -(142 + 235))^math.floor(math.log10(v91)) ;if ((v91/v93)<(18 -14)) then if (v93<=(3 + 7)) then return math.ceil(v91);else v93=v93 * (977.1 -(553 + 424)) ;end end return math.floor((v91/v93) + (0.5 -0) ) * v93 ;end function GetMaxEncumbrance(v94)local v95=0 + 0 ;local v96;local v97;while true do if (v95==1) then if (v94:perkModifier(PerkType.Lift)~=(0 + 0)) then local v440=v94.perks:value(PerkType.Lift);if (v440==(1 + 0)) then v97=40;elseif (v440==(1 + 1)) then v97=46 + 34 ;elseif (v440==3) then v97=260 -140 ;end end return v96 + v97 ;end if (v95==(0 -0)) then v96=v94.strength.curr * (26 -14) ;v97=0 + 0 ;v95=4 -3 ;end end end function RecalcDamageModifier(v98,v99)local v100=0;local v101;while true do if (v100==(753 -(239 + 514))) then v101=1;for v397=0,2 + 3  do local v398=1329 -(797 + 532) ;local v399;while true do if (v398==(0 + 0)) then v399=v98:hitLocation(v397);if ((v399.state~=ArmorLayerState.NotUsed) and (v399.type==v99) and (v399.hp<v399.maxHp)) then v101=math.min(v101,v399.hp/v399.maxHp );end break;end end end v100=1 + 0 ;end if (v100==(2 -1)) then if (v101<=(1202.33 -(373 + 829))) then return 731.5 -(476 + 255) ;elseif (v101<=0.66) then return 1130.75 -(369 + 761) ;else return 1 + 0 ;end break;end end end function SetDefaultStats(v102,v103)v102.strength.curr=v102.strength.base;v102.dexterity.curr=v102.dexterity.base;v102.intelligence.curr=v102.intelligence.base;for v316=0,5 -2  do local v317=0 -0 ;while true do if (v317==(238 -(64 + 174))) then v102:sense(v316).curr=v102:sense(v316).base;v102:percept(v316).curr=v102:percept(v316).base;break;end end end for v318=0 + 0 ,6 do v103:absorbtion(v318).curr=v103:absorbtion(v318).base;end end function ApplyAttackParams(v110,v111,v112)local v113=0 -0 ;if ((v112.weaponType==WeaponType.Bow) or (v112.weaponType==WeaponType.Crossbow)) then if v10[v110.id] then v113=math.max(336 -(144 + 192) ,v110:spellEffect(SpellType.EagleSight) -v10[v110.id][217 -(42 + 174) ] );end end local v114=0;if v110.isPlayer then if (OverloadMod(v110,v111)>(1 + 0)) then v114=(0.5 + 0) * v0 ;end end local v115=0 + 0 ;local v116=1504 -(363 + 1141) ;if v111.isServer then v116=v0 * ((1581 -(1183 + 397)) -RecalcDamageModifier(v111,BodyPartType.Leg)) ;elseif (v111.percepts:value(SenseType.Tracking)>(2 -1)) then v116=((1 + 0) -(v111.percepts:value(SenseType.Tracking)/(75 + 25))) * v0 ;end local v117=1975 -(1913 + 62) ;local v118=0 + 0 ;if v111.isServer then v118=v111:sense(SenseType.Smell).curr;else v118=v111.senses:value(SenseType.Smell);end if (v118<(((2 -1)/3) * 100)) then v117=(1933.25 -(565 + 1368)) * v0 ;elseif (v118<(((7 -5)/(1664 -(1477 + 184))) * (136 -36))) then v117=(0.125 + 0) * v0 ;end local v119=856 -(564 + 292) ;local v120=1 + ((0.02 -0) * (GetDexterity(v111) -25)) ;local v121=210 -140 ;if v110.currWeapon then v121=v110.currWeapon.actions;elseif v110.nawActions then v121=v110.nawActions;end local v122=(305 -(244 + 60)) -(v111:perkModifier(PerkType.Mana) * 0.01) ;local v123=((v121 * v122)/v120)/5 ;if (( not v110.isPlayer and (v118<(66 + v123))) or  not v110.isAggressive or IsMage(v110)) then v119=(0.25 + 0) * v0 ;end local v124=0;if (v110.pose==UnitPoseType.Crawl) then v124=(476.25 -(41 + 435)) * v0 ;elseif ((v110.pose==UnitPoseType.Lay) or (v110.pose==UnitPoseType.Rest)) then v124=(1001.5 -(938 + 63)) * v0 ;end local v125=0;local v126=(((v113-v115) -v114) -v117) -v119 ;local v127=((((v115-v114) -v117) -v116) -v124) + v125 ;v112.attack=math.max(0,v112.attack + v126 );v112.defense=math.max(0,v112.defense + v127 );end function CalcAttackParamsOnServer(v130,v131,v132,v133)local v134=0;local v135;local v136;local v137;while true do if (v134==2) then ApplyAttackParams(v135,v136,v137);break;end if (v134==(0 + 0)) then v135=UnitServer(v131);v136=UnitServerStats(v130);v134=1;end if (v134==(1126 -(936 + 189))) then v137=AttackParams(v132);v6[v135.id]=v1 + 1 + 0 ;v134=2;end end end function CalcAttackParamsOnClient(v138,v139,v140,v141)local v142=UnitServer(v139);local v143=UnitClientStats(v138);local v144=AttackParams(v140);ApplyAttackParams(v142,v143,v144);end function GetManaBonusOnServer(v145)local v146=1613 -(1565 + 48) ;local v147;local v148;local v149;local v150;local v151;local v152;while true do if (v146==(2 + 1)) then v152=v147.perks:value(PerkType.Mana);if (v152==(1139 -(782 + 356))) then v149=267.9 -(176 + 91) ;elseif (v152==2) then v149=0.8 -0 ;elseif (v152==(4 -1)) then v149=0.7;end v146=1096 -(975 + 117) ;end if (v146==(1875 -(157 + 1718))) then v147=UnitServerStats(v145);v148=GetManaBonus(v147.intelligence.curr);v146=1 + 0 ;end if (v146==(6 -4)) then v151=1;if (v147.currEncumbrance>v147.maxEncumbrance) then v151=2;end v146=10 -7 ;end if (v146==(1019 -(697 + 321))) then v149=(2 -1) -(v147:perkModifier(PerkType.Mana) * (0.01 -0)) ;v150=1;v146=2;end if (v146==4) then return ((v148 * v149)/v150) * v151 ;end end end function GetManaBonusOnClient(v153)local v154=UnitClientStats(v153);local v155=2 -1 ;local v156=v154.perks:value(PerkType.Mana);if (v156==(1 + 0)) then v155=0.9 -0 ;elseif (v156==(5 -3)) then v155=0.8;elseif (v156==3) then v155=0.7;end return GetManaBonus(v154.intelligence) * v155 ;end function GetExpMultiplier(v157)return v157/(1252 -(322 + 905)) ;end function Round(v158)return math.floor(v158 + (611.5 -(602 + 9)) );end function GetStrength(v159)if v159.isServer then return v159.strength.curr;else return v159.strength;end end function GetDexterity(v160)if v160.isServer then return v160.dexterity.curr;else return v160.dexterity;end end function GetIntelligence(v161)if v161.isServer then return v161.intelligence.curr;else return v161.intelligence;end end function RecalcSight(v162,v163)local v164=v163:sense(SenseType.Sight).base;local v165=v163:sense(SenseType.SenseLife).base;local v166=1189 -(449 + 740) ;if v162:armor(ArmorType.Helm) then v166=v162:armor(ArmorType.Helm).absorbtions:value(DamageType.General);elseif v9[v162.id] then v166=v9[v162.id];end local v167=(v164 * math.max(872 -(826 + 46) ,v162:spellEffect(SpellType.EagleSight) -v166 ))/(1047 -(245 + 702)) ;local v168=(v165 * math.max(0 -0 ,v162:spellEffect(SpellType.DetectLife) -v166 ))/(33 + 67) ;local v169=RecalcDamageModifier(v163,BodyPartType.Head);local v170=v6[v162.id];local v171=(v164 + v167) * v169 ;if v162.isPlayer then local v335=0;while true do if (v335==0) then v163.visionArc=1898 -(260 + 1638) ;v163:sense(SenseType.Sight).curr=v171;break;end end elseif (v170>=(v1/(445 -(382 + 58)))) then local v406=0;while true do if (v406==(0 -0)) then v163.visionArc=0;v163:sense(SenseType.Sight).curr=v171;v406=1;end if (v406==1) then v163:sense(SenseType.Hearing).curr=v163:sense(SenseType.Hearing).base;break;end end elseif (v163.visionArc<(0.5 + 0)) then local v462=0 -0 ;while true do if (v462==1) then v163:sense(SenseType.Hearing).curr=v163:sense(SenseType.Hearing).base * ((2 -1) -v163.visionArc) ;break;end if ((1205 -(902 + 303))==v462) then v163.visionArc=v163.visionArc + ((0.5 -0)/v2) ;v163:sense(SenseType.Sight).curr=v171 * (1 -((v163.visionArc * 2 * (11 -6))/v164)) ;v462=1;end end else local v463=0;while true do if (v463==(0 + 0)) then v163.visionArc=0.5;v163:sense(SenseType.Sight).curr=v171 * ((1691 -(1121 + 569)) -((219 -(22 + 192))/v164)) ;v463=1;end if (v463==(684 -(483 + 200))) then v163:sense(SenseType.Hearing).curr=(1463.5 -(1404 + 59)) * v163:sense(SenseType.Hearing).base ;break;end end end v163:sense(SenseType.SenseLife).curr=v163:sense(SenseType.SenseLife).base + v168 ;end function CalcPlayersCount(v173)if PlayerOnMap(v173) then v5[v173.id]=82 -52 ;end local v174=0 -0 ;for v321,v322 in pairs(v5) do if (v322>(765 -(468 + 297))) then local v367=562 -(334 + 228) ;while true do if (v367==(0 -0)) then v5[v321]=v5[v321] -1 ;v174=v174 + (2 -1) ;break;end end else v5[v321]=nil;end end end ItemType={Weapon=22292 -10000 ,Armor=3491 + 8802 ,QuickItem=12294,SpellContainer=1245356 -(141 + 95) };function ItemWeight(v175)if v175 then local v337;local v338;v338=ItemsDatabase.MaterialsTable.getRecord(v175.materialId);if (v175.typeId==ItemType.Armor) then v337=ItemsDatabase.ArmorsTable.getRecord(v175.prototypeId);elseif (v175.typeId==ItemType.Weapon) then v337=ItemsDatabase.WeaponsTable.getRecord(v175.prototypeId);elseif (v175.typeId==ItemType.QuickItem) then v337=ItemsDatabase.QuicksTable.getRecord(v175.prototypeId);else return 0 + 0 ;end return v337.weight * v338.weight ;else return 0 -0 ;end end function ItemsWeight(v176)local v177=0;local v178;while true do if (v177==(2 -1)) then for v407=0,1 + 2  do v178=v178 + ItemWeight(v176:weapon(v407)) ;v178=v178 + ItemWeight(v176:quickItem(v407)) ;end return v178;end if (v177==(0 -0)) then v178=0;for v408=0 + 0 ,7 do v178=v178 + ItemWeight(v176:armor(v408)) ;end v177=1 + 0 ;end end end function OverloadMod(v179,v180)if v180.isServer then return v180.currEncumbrance/v180.maxEncumbrance ;else return math.max(ItemsWeight(v179),v179.itemsWeight)/v180.encumbrance ;end end SpellEffectBaseType={Id=1 -0 ,Power=2 + 0 ,IsAdditive=3};SpellBase={effect={50,213 -(92 + 71) ,25 + 25 ,84 -34 ,815 -(574 + 191) ,50,26 + 24 ,176 -(55 + 71) ,50,50,65 -15 ,50,138 -88 ,10,989 -(714 + 225) ,69 -19 ,14 -4 ,98 -(25 + 23) ,0,168 -118 ,0,0,97 -(11 + 86) ,285 -(175 + 110) ,126 -76 ,1796 -(503 + 1293) ,50,1061 -(810 + 251) ,0 + 0 ,583 -(43 + 490) ,193 -143 ,909 -(240 + 619) ,79 -29 ,50,1794 -(1344 + 400) ,0 + 0 ,0 + 0 ,0 -0 ,1739 -(404 + 1335) ,0 -0 ,18 + 32 ,50},mana={7 + 3 ,4 + 6 ,5 + 5 ,1503 -(711 + 782) ,10,19 -9 ,4 + 6 ,10,29 -19 ,10 + 0 ,10,26 -16 ,10,10,1177 -(645 + 522) ,10,10,47 -37 ,1886 -(1045 + 791) ,15 -5 ,50,555 -(351 + 154) ,316 -(28 + 238) ,50,1569 -(1381 + 178) ,10,9 + 1 ,34 -24 ,10,6 + 4 ,9 + 1 ,7 + 3 ,17 -7 ,21 -11 ,10,5 + 5 ,10,10,10,10,10,39 -29 },complex={636 -(512 + 114) ,26 -16 ,10,10,5 + 5 ,9 + 1 ,2004 -(109 + 1885) ,19 -9 ,10,17 -7 ,2 + 8 ,2 + 8 ,27 -17 ,33 -23 ,10,10,4 + 6 ,5 + 5 ,8 + 2 ,1443 -(797 + 636) ,10,10,4 + 6 ,10,10,10,336 -(192 + 134) ,10,1286 -(316 + 960) ,10,10,10,10,38 -28 ,1816 -(1202 + 604) ,16 -6 ,335 -(45 + 280) ,9 + 1 ,4 + 6 ,2 + 8 ,18 -8 ,1921 -(340 + 1571) },actions={1832 -(1733 + 39) ,1094 -(125 + 909) ,60,41 + 49 ,88 + 2 ,602 -(409 + 103) ,155 -(51 + 44) ,17 + 43 ,1377 -(1114 + 203) ,60,60,723 -(174 + 489) ,1965 -(830 + 1075) ,1329 -(231 + 1038) ,60,50 + 10 ,247 -187 ,60,120,149 -89 ,120,346 -226 ,370 -250 ,120,60,60,60,60,583 -(423 + 100) ,60,1 + 59 ,60,60,60,60,140 -80 ,60,92 -(19 + 13) ,139 -79 ,60,60,105 -45 },area={1812 -(1293 + 519) ,0 -0 ,0,7 -3 ,17 -13 ,3 + 1 ,4 -2 ,2,2 + 0 ,0,1858 -(673 + 1185) ,0 -0 ,0,0,0,0,0 -0 ,0 -0 ,4,0 -0 ,1884 -(446 + 1434) ,1283 -(1040 + 243) ,0,0,1931 -(609 + 1322) ,0,0,0,0 + 0 ,0 -0 ,0 + 0 ,0 + 0 ,0,0 -0 ,0,0 + 0 ,0 + 0 ,0,433 -(153 + 280) ,0,0,0 + 0 },int_mod={"add","add","add","add","add","add","add","add","add","add","add","add","add","mul","add","add","mul","add","mul","add","mul","mul","mul","mul","add","mul","mul","mul","mul","add","add","add","add","add","add","mul","mul","mul","mul","mul","add","add"},combat_rest={false,false,false,false,false,false,false,false,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,false},subtype={181 -(92 + 89) ,1 + 0 ,2 + 0 ,0 -0 ,2 -1 ,2 + 0 ,0 -0 ,1 -0 ,2,0,1136 -(832 + 303) ,948 -(88 + 858) ,2 + 2 ,1 + 3 ,793 -(766 + 23) ,3 -0 ,10 -7 ,1076 -(1036 + 37) ,5 -2 ,6,4,9 -5 ,2 + 1 ,2 + 2 ,860 -(174 + 680) ,14 -7 ,5,744 -(396 + 343) ,1482 -(29 + 1448) ,5,1394 -(135 + 1254) ,6,6,3 + 1 ,4,7,7,5,5,0 + 0 ,0,1},attribute={"str","str","str","str","str","str","str","str","str","int","int","int","int","int","int","int","int","int","dex","dex","dex","dex","dex","dex","int","dex","int","int","int","int","dex","int","dex","int","dex","int","int","int","int","int","str","str"}};RunesBase={type={"R","R","R","R","T","T","T","T","A","A","A","A","E","E","E","E","D","D","D","D","M","M","M","M","Ff","Ef","It","Ic","E"},value={221.5 -(55 + 166) ,1 + 0 ,3.5 -2 ,3 -1 ,1,2,3,4,0.5 + 0 ,1,1.5,23 -(20 + 1) ,319.1 -(134 + 185) ,685.2 -(314 + 371) ,0.3 -0 ,0.4 + 0 ,0.5,1,1.5,2, -(1345 -(1093 + 247)), -10, -(2 + 13), -(67 -47),0,0,0 + 0 ,0, -0.1},mana={5,10,12 + 3 ,20,5,27 -17 ,15,7 + 13 ,10,10,1278 -(1249 + 19) ,10,10 + 0 ,1096 -(686 + 400) ,239 -(73 + 156) ,1 + 9 ,5,1 + 9 ,485 -(224 + 246) ,32 -12 , -(1 + 4), -(1 + 9), -15, -(66 -46),518 -(203 + 310) ,1998 -(1238 + 755) ,1 + 9 ,36 -16 ,0},complexity={19 -14 ,843 -(171 + 662) ,52 -37 ,20,2 + 3 ,1496 -(35 + 1451) ,15,20 + 0 ,6 -1 ,307 -(45 + 252) ,15,20,2 + 3 ,24 -14 ,15,20,6 -1 ,7 + 3 ,22 -7 ,1983 -(556 + 1407) ,470 -(170 + 295) ,6 + 4 ,36 -21 ,20,4 + 1 ,1235 -(957 + 273) ,3 + 7 ,20, -(13 -8)},area={0 -0 ,0,0 + 0 ,0 -0 ,0 -0 ,311 -(309 + 2) ,0 -0 ,0,0.5 + 0 ,1,1119.5 -(628 + 490) ,1 + 1 ,0 -0 ,0,0 -0 ,0 -0 ,0 + 0 ,15 -(6 + 9) ,0,0,169 -(28 + 141) ,0 -0 ,0 + 0 ,0,0,0 -0 ,0,0 -0 ,0}};function CalcRunesPower(v181)local v182=0;for v323=1263 -(668 + 595) ,7 + 0  do local v324=v181.runeIds:value(v323);if (RunesBase.type[v324]=="E") then v182=v182 + RunesBase.value[v324] ;end end return v182;end function CalcRunesMana(v183)local v184=0 + 0 ;for v325=0 -0 ,297 -(23 + 267)  do local v326=v183.runeIds:value(v325);if (v326>(1944 -(1129 + 815))) then v184=v184 + RunesBase.mana[v326] ;end end return v184;end function CalcRunesArea(v185)local v186=0;for v327=387 -(371 + 16) ,1757 -(1326 + 424)  do local v328=0 -0 ;local v329;while true do if ((0 -0)==v328) then v329=v185.runeIds:value(v327);if (RunesBase.type[v329]=="A") then v186=v186 + RunesBase.area[v329] ;end break;end end end return v186;end function RecalcSpellPower(v187,v188,v189,v190)local v191=118 -(88 + 30) ;local v192;local v193;local v194;local v195;local v196;while true do if (v191==(773 -(720 + 51))) then v188.manaCost=SpellBase.mana[v192] + math.max(0 -0 ,v194) ;v188.effect.radius=math.sqrt((SpellBase.area[v192] * ((1777 -(421 + 1355)) + v195))/math.pi );if v189 then local v443=0 -0 ;while true do if (1==v443) then v188.effect.radius=((SpellBase.area[v192]/math.sqrt(math.pi)) * (1 + 0 + v195) * v196)/(1108 -(286 + 797)) ;break;end if (v443==(0 -0)) then if  not v190 then v188.manaCost=v188.manaCost/(1656 -656) ;end if (v188.subtypeId==SpellType.Healing) then v188.effect.power=v188.effect.power/(1439 -(397 + 42)) ;end v443=1;end end end break;end if (v191==(0 + 0)) then v192=v188.subtypeId + (801 -(24 + 776)) ;v193=CalcRunesPower(v188);v194=CalcRunesMana(v188);v195=CalcRunesArea(v188);v191=1 -0 ;end if ((786 -(222 + 563))==v191) then v196=25;if v189 then if (SpellBase.attribute[v192]=="str") then v196=GetStrength(v187);elseif (SpellBase.attribute[v192]=="dex") then v196=GetDexterity(v187);elseif (SpellBase.attribute[v192]=="int") then v196=GetIntelligence(v187);end end if (SpellBase.int_mod[v192]=="add") then v188.effect.power=((SpellBase.effect[v192] * ((1 -0) + v193)) + v196) -25 ;elseif (SpellBase.int_mod[v192]=="mul") then v188.effect.power=(SpellBase.effect[v192] * (1 + 0 + v193) * v196)/25 ;end if v189 then end v191=2;end end end function RecalcSpellActions(v197,v198,v199)local v200=v197:sense(SenseType.Smell).curr;local v201=v198.subtypeId + 1 ;local v202=1 -(v197:perkModifier(PerkType.Mana) * 0.01) ;local v203=(191 -(23 + 167)) + (v197:perkModifier(PerkType.Spirit) * (1798.01 -(690 + 1108))) ;local v204=(361 + 639) * v198.manaCost * GetManaBonus(v197.intelligence.curr) * v202 ;local v205=((83 + 17) * v3 * v203)/(853 -(40 + 808)) ;local v206=(SpellBase.actions[v201] * (3 + 12))/v197.actions.curr ;local v207=v200 + (v206 * v205) ;if (v199 and (v207<v204)) then local v339=0 -0 ;local v340;while true do if (v339==(0 + 0)) then v340=(((v204-v207)/v205) * v197.actions.curr)/(8 + 7) ;v198.actions=SpellBase.actions[v201] + v340 ;break;end end else v198.actions=SpellBase.actions[v201];end end SkillTypeFromSpellSubtype={3,2 + 1 ,4 -1 ,1730 -(1165 + 561) ,12 -8 ,5,5,5};PerkTypeFromSpellSubtype={333 -(89 + 237) ,25 -17 ,18 -9 ,1230 -(855 + 365) ,23 -13 ,4 + 8 ,12 + 0 ,298 -(156 + 130) };function DisableItemEnchant(v208,v209,v210)local v211=0 -0 ;local v212;while true do if (v211==0) then v212=SpellBase.subtype[v209.spell.subtypeId + (1 -0) ];if ((v210>(1 -0)) or (((v208.autoSkills:value(SkillTypeFromSpellSubtype[v212 + 1 + 0 ]) + v208:perkModifier(PerkTypeFromSpellSubtype[v212 + 1 + 0 ]) + v208.intelligence.curr) -(94 -(10 + 59)))<v209.spell.complexity)) then v209.mp= -(1 + 0);v209.mpMax= -(4 -3);elseif (v209.mp<(1163 -(671 + 492))) then local v483=0 + 0 ;while true do if (v483==(1215 -(369 + 846))) then v209.mpMax=100;v209.mp=27 + 73 ;break;end end end break;end end end ManaFromArmorType={2005 -(1036 + 909) ,80,50,40,20,16 + 14 ,48 -28 };ManaFromWeaponType={40,60,20,40,256 -(50 + 126) ,7 + 23 ,50};function RecalcItemEnchant(v213,v214,v215,v216)if v215 then if v215.spell then local v409=1413 -(1233 + 180) ;while true do if ((969 -(522 + 447))==v409) then RecalcSpellPower(v214,v215.spell,v216,true);DisableItemEnchant(v214,v215,OverloadMod(v213,v214));v409=1422 -(107 + 1314) ;end if (v409==(1 + 0)) then if  not v216 then if (v215.typeId==ItemType.Armor) then v215.mpMax=ManaFromArmorType[v215.prototype.typeId + (2 -1) ];elseif (v215.typeId==ItemType.Weapon) then v215.mpMax=ManaFromWeaponType[v215.prototype.typeId + 1 + 0 ];end end if (v215.mpMax>(0 -0)) then local v513=0;local v514;while true do if (0==v513) then v514=v215.spell.subtypeId;if (v216 and (v6[v213.id]<=(0 -0)) and ((v514<=SpellType.PoisonFog) or (v514==SpellType.Healing))) then v215.regenRate=v3;else v215.regenRate=(1911 -(716 + 1194))/(v215.mpMax * (1 + 14)) ;end break;end end end break;end end end end end function RecalcPlayerSpells(v217,v218,v219)local v220=0 + 0 ;while true do if (v220==0) then for v410=503 -(74 + 429) ,13 -6  do if v217:spell(v410) then local v465=0 + 0 ;while true do if (v465==(0 -0)) then RecalcSpellPower(v218,v217:spell(v410).spell,v219,false);RecalcSpellActions(v218,v217:spell(v410).spell,v219);break;end end end RecalcItemEnchant(v217,v218,v217:armor(v410),v219);end for v411=0 + 0 ,8 -5  do local v412=0;while true do if (v412==(0 -0)) then RecalcItemEnchant(v217,v218,v217:weapon(v411),v219);RecalcItemEnchant(v217,v218,v217:quickItem(v411),v219);break;end end end break;end end end function PlayerOnMap(v221)if v221.isPlayer then local v343=433 -(279 + 154) ;local v344;while true do if (v343==(778 -(454 + 324))) then v344=v221.id-(786760183 + 213239817) ;if ((v344<(1017 -(12 + 5))) or (v344>1000000)) then return true;end v343=1 + 0 ;end if (v343==(2 -1)) then return false;end end else return true;end end function GetUnitArmor(v222,v223,v224)local v225=0 + 0 ;local v226;while true do if (v225==(1093 -(277 + 816))) then v226=0 -0 ;if v222.isPlayer then v226=CalcArmor(v222,v224);else v226=v223:absorbtion(v224).curr;end v225=1184 -(1058 + 125) ;end if (v225==1) then v9[v222.id]=v226;return v226;end end end function CalcArmor(v227,v228)local v229=0;local v230;while true do if ((1 + 0)==v229) then return v230;end if (v229==(975 -(815 + 160))) then v230=0;for v413=0 -0 ,6 do if v227:armor(v413) then local v466=0;local v467;while true do if (v466==1) then v230=v230 + v467 ;break;end if (v466==(0 -0)) then v467=v227:armor(v413).absorbtions:value(v228);if (v413==ArmorType.Helm) then v467=(v467 * (1 + 0))/(29 -19) ;elseif (v413==ArmorType.Plate) then v467=(v467 * 6)/10 ;elseif (v413==ArmorType.Leggins) then v467=(v467 * (1901 -(41 + 1857)))/(1903 -(1222 + 671)) ;elseif (v413==ArmorType.Shirt) then v467=(v467 * (15 -9))/10 ;elseif (v413==ArmorType.Pants) then v467=(v467 * (3 -0))/10 ;elseif (v413==ArmorType.Boots) then v467=(v467 * 3)/(1192 -(229 + 953)) ;elseif (v413==ArmorType.Gloves) then v467=(v467 * 3)/10 ;end v466=1775 -(1111 + 663) ;end end end end v229=1580 -(874 + 705) ;end end end function RecalcArmor(v231,v232)if v231.isPlayer then return false;end if IsHumanoid(v231) then for v373=0,1 + 5  do local v374=0 + 0 ;while true do if (v374==0) then v232:absorbtion(v373).curr=0 -0 ;v232:absorbtion(v373):addCurr(CalcArmor(v231,v373));break;end end end else local v345=0 + 0 ;while true do if (v345==(680 -(642 + 37))) then if (v232.mp.regen==(1 + 0)) then v232:absorbtion(DamageType.Crushing).curr=v232:absorbtion(DamageType.Crushing).curr-(4 + 16) ;end break;end if (v345==(0 -0)) then for v469=454 -(233 + 221) ,5 do local v470=v232:absorbtion(DamageType.General).curr;local v471=0 -0 ;if (v470~=(0 + 0)) then v471=(v232:absorbtion(v469).curr/v470) -(1542 -(718 + 823)) ;end v232:absorbtion(v469).curr=math.max(0,v470 + (v471 * (63 + 37)) );end v232:absorbtion(DamageType.General).curr=math.max(805 -(266 + 539) ,v232:absorbtion(DamageType.General).curr);v345=2 -1 ;end end end end function IsHumanoid(v233)local v234=0;while true do if (v234==1) then return false;end if (v234==(1225 -(636 + 589))) then if v233.isPlayer then return true;end for v414=0 -0 ,6 do if v233:armor(v414) then return true;end end v234=1 -0 ;end end end function IsMage(v235)if v235.isPlayer then return false;end for v330=0,6 + 1  do if v235:spell(v330) then if ((v235:spell(v330).spell.subtypeId<=SpellType.PoisonFog) or (v235:spell(v330).spell.subtypeId>=SpellType.RickMagic)) then return true;end end end return false;end function GetMaxComplexity(v236)local v237=0 + 0 ;for v331=1015 -(657 + 358) ,7 do if v236:spell(v331) then v237=math.max(v237,v236:spell(v331).spell.complexity);end end return v237;end function RecalcActions(v238,v239,v240,v241)v239.actionsDamageModifier=RecalcDamageModifier(v239,BodyPartType.Hand);local v243=0.3 -0 ;v239.actions.base=15 + (v243 * (GetDexterity(v239) -25)) ;local v245=GetUnitArmor(v238,v240,DamageType.General);local v246=2 -1 ;if v10[v238.id] then v246=v10[v238.id][1];else v246=v245;end local v247=GetMaxComplexity(v238);local v248=math.max(1187 -(1151 + 36) ,v241:value(SpellType.Speed) -math.max(v246,v245,v247) );local v249=math.max(0 + 0 ,v241:value(SpellType.Slow) -math.max(v246,v245,v247) );local v250=(v248-v249)/(3 + 7) ;if (v250<(0 -0)) then v250=(1833 -(1552 + 280))/(1 -v250) ;else v250=1 + v250 ;end local v251=(835 -(64 + 770)) + (v239:perkModifier(PerkType.Quickness)/100) ;v239.actions.curr=math.max(1 + 0 ,v239.actions.base * v251 * v250 * v239.actionsDamageModifier );end function RecalcBackstab(v253,v254)local v255=v253.perks:value(PerkType.Backstab);if (v255==0) then return false;end local v256=26 -14 ;if ((v255<=3) and v254) then v253.perks:set(PerkType.Backstab,v255 + v256 );elseif ((v255>(1 + 2)) and  not v254) then v253.perks:set(PerkType.Backstab,v255-v256 );end end function RecalcVitality(v257,v258)local v259=v257.perks:value(PerkType.Vitality);if (v259==(1243 -(157 + 1086))) then return false;end local v260=53 -26 ;if ((v259<=(13 -10)) and v258) then v257.perks:set(PerkType.Vitality,v259 + v260 );elseif ((v259>(3 -0)) and  not v258) then v257.perks:set(PerkType.Vitality,v259-v260 );end end function RecalcMana(v261,v262)local v263=v261.perks:value(PerkType.Mana);if (v263==(0 -0)) then return false;end local v264=852 -(599 + 220) ;if ((v263<=3) and v262) then v261.perks:set(PerkType.Mana,v263 + v264 );elseif ((v263>(5 -2)) and  not v262) then v261.perks:set(PerkType.Mana,v263-v264 );end end function ApplySpellEffects(v265,v266,v267,v268)local v269=v268;local v270=GetUnitArmor(v265,v267,DamageType.General);local v271=math.max(1931 -(1813 + 118) ,v269:value(SpellType.Antimagic) -v270 );local v272=math.max(v271,v269:value(SpellType.ProtFire) -v270 );local v273=math.max(v271,v269:value(SpellType.ProtElectric) -v270 );local v274=math.max(v271,v269:value(SpellType.ProtAcid) -v270 );v267:absorbtion(DamageType.Termical):addCurr(v272);v267:absorbtion(DamageType.Electrical):addCurr(v273);v267:absorbtion(DamageType.Chemical):addCurr(v274);local v275=math.max(0 + 0 ,v269:value(SpellType.Invisibility) -v270 )/100 ;v266:percept(SenseType.Sight).curr=math.max(1217 -(841 + 376) ,v266:percept(SenseType.Sight).curr-v275 );v266:percept(SenseType.Hearing).curr=math.max(0 -0 ,v266:percept(SenseType.Hearing).curr-v269:value(SpellType.Silence) );local v278=math.max(0 + 0 ,v269:value(SpellType.Lichdom) -v270 )/(272 -172) ;v266:percept(SenseType.SenseLife).curr=math.max(859 -(464 + 395) ,v266:percept(SenseType.SenseLife).curr-v278 );end function ApplyCustomEffects(v280,v281,v282,v283,v284)local v285=0 -0 ;local v286;while true do if (v285==2) then if v280.currWeapon then for v473=0,3 + 3  do v281.nawAttacks:set(v473,v280.currWeapon.prototype.damageDistributions:value(v473));end end if (v10[v280.id]==nil) then local v450=837 -(467 + 370) ;local v451;while true do if ((0 -0)==v450) then v451=GetUnitArmor(v280,v282,DamageType.General);v10[v280.id]={v451,v451};break;end end end v285=3;end if ((1 + 0)==v285) then RecalcPlayerSpells(v280,v281,v286);if v280.isPlayer then RecalcBackstab(v281,v286);RecalcVitality(v281,v286);RecalcMana(v281,v286);end v285=6 -4 ;end if (v285==(1 + 2)) then if IsHumanoid(v280) then local v452=0;local v453;local v454;while true do if (v452==(0 -0)) then v453=GetStrength(v281)/25 ;v454=v281:perkModifier(PerkType.Health) * 0.01 ;if (v454>0) then v454=(521 -(150 + 370)) -v454 ;end v452=1283 -(74 + 1208) ;end if (v452==(2 -1)) then v281:hitLocation(HitLocationType.Head).hpWeight=(4.5 -3) + v454 ;v281:hitLocation(HitLocationType.Left_hand).vitality=(0.334 + 0) * v453 ;v281:hitLocation(HitLocationType.Left_hand).hpWeight=1 * v453 ;v452=392 -(14 + 376) ;end if (v452==(4 -1)) then v281:hitLocation(HitLocationType.Left_leg).hpWeight=(2 + 0) * v453 ;v281:hitLocation(HitLocationType.Right_leg).vitality=(0.667 + 0) * v453 ;v281:hitLocation(HitLocationType.Right_leg).hpWeight=(2 + 0) * v453 ;break;end if (v452==(5 -3)) then v281:hitLocation(HitLocationType.Right_hand).vitality=(0.334 + 0) * v453 ;v281:hitLocation(HitLocationType.Right_hand).hpWeight=1 * v453 ;v281:hitLocation(HitLocationType.Left_leg).vitality=(78.667 -(23 + 55)) * v453 ;v452=6 -3 ;end end end if v280.currWeapon then local v455=0 + 0 ;while true do if (v455==(0 + 0)) then v10[v280.id]={v280.currWeapon.damageMin,v280.currWeapon.damageMax};v11[v280.id]=v280.currWeapon.actions;break;end end end break;end if (v285==0) then v286=PlayerOnMap(v280);if (v282.hp.curr<=0) then v286=false;end v285=902 -(652 + 249) ;end end end function RecalcUnitStats(v287,v288,v289,v290)local v291=UnitServerStats(v287);local v292=UnitServerCommonStats(v288);local v293=UnitServer(v289);local v294=Array(v290,Memory.Type.Float,40,true);if (v6[v293.id]==nil) then v6[v293.id]=0;end local v295=v292.hp.curr==v292.hp.max ;SetDefaultStats(v291,v292);ApplyPerks(v291);ApplySpellEffects(v293,v291,v292,v294);ApplyCustomEffects(v293,v291,v292,v294,v288);RecalcSight(v293,v291);RecalcArmor(v293,v292);if  not v293.isPlayer then local v348=0 -0 ;while true do if (v348==1) then v291.intelligence.base=v291.manualSkills:value(ManualSkillType.Tame);break;end if (v348==(1868 -(708 + 1160))) then v291.strength.base=v291.autoSkills:value(AutoSkillType.Archery);v291.dexterity.base=v291.manualSkills:value(ManualSkillType.Stealing);v348=2 -1 ;end end end if v293.isPlayer then for v375=0 -0 ,30 -(10 + 17)  do if (v293:weapon(v375) and (v293:weapon(v375).durability<(0 + 0))) then v293:weapon(v375).durability=1732 -(1400 + 332) ;end end end v292.hp.max=GetModifiedHealth(v287,v289,v292.hp.max);v291:distributeHp(v292.hp.max);if v293.isPlayer then v291.maxEncumbrance=GetMaxEncumbrance(v291);else v291.maxEncumbrance=1918085 -918085 ;end v291.currEncumbrance=v293.itemsWeight;v291:percept(SenseType.Hearing).curr=math.max(1909 -(242 + 1666) ,v291.currEncumbrance/300 );if v293.isPlayer then end RecalcActions(v293,v291,v292,v294);v291.moveDamageModifier=1;if (v291.locomotion==LocomotionType.Walk) then v291.moveDamageModifier=RecalcDamageModifier(v291,BodyPartType.Leg);end v291.move.curr=v291.move.base * v291.moveDamageModifier ;if (v293.isPlayer and  not PlayerOnMap(v293)) then v291.move.curr=43 + 57 ;end v292.hp.curr=v291:collectHp(v292.hp.max);if v295 then v291:heal(v288,37 + 63 );end end function RecalcInternalHeroStats(v303,v304)local v305=0 + 0 ;local v306;local v307;while true do if (v305==1) then for v415=940 -(850 + 90) ,4 -1  do v306:sense(v415).curr=v306:sense(v415).base;v306:percept(v415).curr=v306:percept(v415).base;end ApplyPerks(v306);v306:distributeHp(CalcBaseHealth(v303));v306.currEncumbrance=v304;v305=1392 -(360 + 1030) ;end if (v305==(2 + 0)) then v306.maxEncumbrance=GetMaxEncumbrance(v306);v306.moveDamageModifier=RecalcDamageModifier(v306,BodyPartType.Leg);v306.move.curr=v306.move.base * v306.moveDamageModifier ;v306.actionsDamageModifier=RecalcDamageModifier(v306,BodyPartType.Hand);v305=7 -4 ;end if (v305==(3 -0)) then v306.actions.base=(1671 -(909 + 752)) + (v306.dexterity.curr * (1223.2 -(109 + 1114))) ;v307=(1 -0) + (v306:perkModifier(PerkType.Quickness)/100) ;v306.actions.curr=math.max(1 + 0 ,v306.actions.base * v306.actionsDamageModifier * v307 );break;end if (v305==(242 -(6 + 236))) then v306=UnitServerStats(v303);v306.strength.curr=v306.strength.base;v306.dexterity.curr=v306.dexterity.base;v306.intelligence.curr=v306.intelligence.base;v305=1;end end end function GetExpMultiplier(v308)return (2 + 0)^((v308-25)/(9 + 1)) ;end function RecalcShopsPriceMultipliers(v309,v310)local v311=0 -0 ;local v312;local v313;local v314;while true do if (v311==(1 -0)) then v314=Array(v309,Memory.Type.Float,v312 * v313 ,false);for v420=1133 -(1076 + 57) ,1 + 2  do v314:set((v420 * v313) + 3 ,0);v314:set((v420 * v313) + 7 ,689 -(579 + 110) );v314:set((v420 * v313) + 1 + 7 ,0.5);end break;end if (v311==(0 + 0)) then v312=(v310 and (3 + 1)) or 5 ;v313=9;v311=1;end end end